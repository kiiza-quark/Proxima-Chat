import pandas as pd

# Load the requests CSV generated by Locust
df = pd.read_csv("locust_results_requests.csv")

# Filter for /api/chat endpoint
chat_df = df[df['Name'].str.contains('/api/chat')]

# Calculate summary stats
summary = {
    "Total Requests": chat_df['Request Count'].sum(),
    "Failures": chat_df['Failure Count'].sum(),
    "Median Response Time (ms)": chat_df['Median Response Time'].median(),
    "Average Response Time (ms)": chat_df['Average Response Time'].mean(),
    "95th Percentile Response Time (ms)": chat_df['95th Percentile Response Time'].max(),
    "Requests Per Second": chat_df['Requests/s'].sum(),
    "Failure Rate (%)": 100 * chat_df['Failure Count'].sum() / chat_df['Request Count'].sum() if chat_df['Request Count'].sum() > 0 else 0
}

print("Locust /api/chat Endpoint Summary:")
for k, v in summary.items():
    print(f"{k}: {v}")